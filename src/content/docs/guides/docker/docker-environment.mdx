---
title: "Docker Environment Variables"
description: "Learn how to configure containers with environment variables for flexible, secure deployments."
sidebar:
  label: "Environment Variables"
  order: 6
  badge:
    text: "Mid"
    variant: "caution"
tableOfContents: true
---

import { Aside, Badge, Steps } from "@astrojs/starlight/components";
import Quiz from "../../../../components/Quiz.astro";
import Flashcard from "../../../../components/Flashcard.astro";
import ProgressCheck from "../../../../components/ProgressCheck.astro";

<Badge text="Docker" class="docker" />
<Badge text="Linux" class="linux" />

Environment variables are the primary way to configure containers without modifying images. They're essential for passing configuration, credentials, and runtime settings.

<Aside type="tip" title="12-Factor App">
  Environment variables follow the 12-factor app methodology - keeping
  configuration separate from code for flexible deployments.
</Aside>

---

## Setting Environment Variables

### Using the -e Flag

Pass individual variables with `-e` or `--env`:

```bash
docker run -e MESSAGE="Hello DevHub" -p 8080:80 nginx
```

### Multiple Variables

Repeat the `-e` flag for each variable:

```bash
docker run -d \
  -e MYSQL_ROOT_PASSWORD=rootpass \
  -e MYSQL_DATABASE=myapp \
  -e MYSQL_USER=appuser \
  -e MYSQL_PASSWORD=apppass \
  mysql:8.0
```

### From Host Environment

Pass through a host environment variable:

```bash
export API_KEY="sk-12345"
docker run -e API_KEY myapp
```

Without a value, Docker uses the host's value.

---

## Environment Files

For many variables, use an env file:

### Create .env File

```bash
# .env
MESSAGE=Hello from file
DATABASE_URL=postgres://user:pass@db:5432/mydb
API_KEY=sk-production-key
DEBUG=false
```

### Use with --env-file

```bash
docker run --env-file .env -p 8080:80 myapp
```

<Aside type="caution" title="Security Warning">
  Never commit `.env` files with secrets to version control. Add `.env` to your
  `.gitignore`.
</Aside>

<Flashcard
  title="Env File Usage"
  cards={[
    {
      front: "How do you pass multiple environment variables from a file?",
      back: "Use --env-file .env to load all variables from the .env file into the container.",
    },
  ]}
/>

---

## Environment Variables in Dockerfile

### ENV Instruction

Set default values in your Dockerfile:

```dockerfile
FROM node:18-alpine

# Set environment variables
ENV NODE_ENV=production
ENV PORT=3000
ENV APP_NAME="My Application"

EXPOSE $PORT

CMD ["node", "server.js"]
```

### Override at Runtime

Dockerfile defaults can be overridden:

```bash
# Uses Dockerfile defaults
docker run myapp

# Override NODE_ENV
docker run -e NODE_ENV=development myapp
```

### ARG vs ENV

| Instruction | Available at      | Persists in image |
| ----------- | ----------------- | ----------------- |
| `ARG`       | Build time only   | ❌ No             |
| `ENV`       | Build and runtime | ✅ Yes            |

```dockerfile
# Build-time variable
ARG VERSION=1.0.0

# Runtime variable (can use ARG value)
ENV APP_VERSION=$VERSION
```

---

## Docker Compose Environment

### Inline Variables

```yaml
version: "3.9"
services:
  web:
    image: myapp
    environment:
      - NODE_ENV=production
      - DATABASE_URL=postgres://db:5432/app
      - DEBUG=false
```

### Using env_file

```yaml
version: "3.9"
services:
  web:
    image: myapp
    env_file:
      - .env
      - .env.local
```

### Variable Substitution

Docker Compose automatically loads `.env` from the same directory:

```yaml
# docker-compose.yml
version: "3.9"
services:
  db:
    image: mariadb:10.6
    environment:
      - MYSQL_ROOT_PASSWORD=${ROOT_PASSWORD}
      - MYSQL_DATABASE=wordpress
      - MYSQL_USER=wordpress
      - MYSQL_PASSWORD=${MYSQL_PW}

  wordpress:
    image: wordpress:latest
    environment:
      - WORDPRESS_DB_HOST=db
      - WORDPRESS_DB_USER=wordpress
      - WORDPRESS_DB_PASSWORD=${MYSQL_PW}
      - WORDPRESS_DB_NAME=wordpress
```

```bash
# .env (same directory as docker-compose.yml)
MYSQL_PW=SecurePassword123
ROOT_PASSWORD=RootPassword456
```

<Aside type="tip" title="Compose .env Auto-loading">
  Docker Compose automatically reads `.env` from the project directory. No need
  for `--env-file` flag.
</Aside>

---

## Viewing Container Environment

### Inspect Environment

```bash
docker inspect mycontainer --format '{{range .Config.Env}}{{println .}}{{end}}'
```

### Exec into Container

```bash
docker exec mycontainer env
docker exec mycontainer printenv DATABASE_URL
```

---

## Best Practices

### 1. Don't Hardcode Secrets

```dockerfile
# ❌ Bad - secrets in Dockerfile
ENV DATABASE_PASSWORD=mysecret

# ✅ Good - set at runtime
# docker run -e DATABASE_PASSWORD=mysecret myapp
```

### 2. Use Descriptive Names

```bash
# ❌ Bad
-e PW=abc123

# ✅ Good
-e DATABASE_PASSWORD=abc123
```

### 3. Provide Defaults for Non-Secrets

```dockerfile
ENV LOG_LEVEL=info
ENV MAX_CONNECTIONS=100
ENV CACHE_TTL=3600
```

### 4. Document Required Variables

```dockerfile
# Required environment variables:
# - DATABASE_URL: PostgreSQL connection string
# - API_KEY: External API authentication
# - SECRET_KEY: Application secret for sessions
```

### 5. Use .env.example

Create a template without secrets:

```bash
# .env.example (commit this)
DATABASE_URL=postgres://user:password@host:5432/dbname
API_KEY=your-api-key-here
SECRET_KEY=generate-a-secret

# .env (gitignored, actual values)
DATABASE_URL=postgres://admin:realpass@db:5432/prod
API_KEY=sk-live-xxxxx
SECRET_KEY=abc123def456
```

---

## Common Patterns

### Database Configuration

```bash
# PostgreSQL
docker run -d \
  -e POSTGRES_USER=myuser \
  -e POSTGRES_PASSWORD=mypass \
  -e POSTGRES_DB=mydb \
  postgres:15

# MySQL/MariaDB
docker run -d \
  -e MYSQL_ROOT_PASSWORD=rootpass \
  -e MYSQL_DATABASE=mydb \
  -e MYSQL_USER=myuser \
  -e MYSQL_PASSWORD=mypass \
  mysql:8.0
```

### Application Configuration

```bash
docker run -d \
  -e NODE_ENV=production \
  -e PORT=3000 \
  -e DATABASE_URL="postgres://..." \
  -e REDIS_URL="redis://..." \
  -e LOG_LEVEL=warn \
  myapp
```

---

## Knowledge Check

<Quiz
  question="How do you pass multiple environment variables from a file?"
  options={["-e file.env", "--env-file .env", "--vars .env", "-f .env"]}
  correct={1}
  explanation="Use --env-file .env to load all variables defined in the file."
/>

<Quiz
  question="What's the difference between ARG and ENV in Dockerfile?"
  options={[
    "No difference",
    "ARG is build-time only, ENV persists at runtime",
    "ENV is build-time only",
    "ARG is for secrets",
  ]}
  correct={1}
  explanation="ARG is only available during build. ENV is available both at build time and runtime in the container."
/>

---

## Progress Checklist

<ProgressCheck
  id="docker-environment"
  title="Environment Variables Checklist"
  items={[
    "Pass variables with -e flag",
    "Use environment files",
    "Set ENV in Dockerfile",
    "Use Docker Compose environment",
    "Variable substitution in Compose",
    "Create .env.example template",
  ]}
/>

---

## Source

Based on [Docker Environment Variables](https://docs.docker.com/compose/environment-variables/) and DevHub examples.
